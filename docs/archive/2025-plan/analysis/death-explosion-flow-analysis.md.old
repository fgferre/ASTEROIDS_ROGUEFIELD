> [!NOTE]
Documento arquivado em 2025-10-10. Itens rastreados no novo plano: Seção 5.1 Feedback Sensorial. Consulte `docs/plans/docs-implementation-master-plan.md` para objetivos e critérios atualizados.

# Death & Explosion Flow - Auditoria 2025-02-15

## ✅ Situação Atual
- A sequência natural de morte continua funcionando conforme previsto: colisões fatais invocam `WorldSystem.handlePlayerDeath()`, que emite `player-died` com a posição e dispara `EffectsSystem.createEpicShipExplosion()`.
- A saída pelo menu de pausa foi corrigida em `exitToMenu()`: agora a função detecta `payload.source === 'pause-menu'`, desfaz a pausa, exibe o HUD de jogo, aciona a explosão épica diretamente no `EffectsSystem`, oculta temporariamente a nave e só executa o retorno ao menu após `setTimeout` de 3.5 s.
- O jogador volta a ser renderizado normalmente quando uma nova sessão inicia (`player._quitExplosionHidden` é resetado).

## Fluxos Relevantes

### Morte natural do jogador
```
PhysicsSystem detecta colisão fatal
  ↓
WorldSystem.handlePlayerDeath()
  ↓
Emite 'player-died' com posição
  ↓
EffectsSystem.createEpicShipExplosion(posição)
  ↓
UISystem mostra tela de game over
```

### Sair pelo menu de pausa
```
Clique em "Quit" dentro do pause
  ↓
exitToMenu({ source: 'pause-menu' })
  ↓
Despausa o jogo e exibe HUD de jogo
  ↓
Recupera player/effects via gameServices
  ↓
EffectsSystem.createEpicShipExplosion(posição atual)
  ↓
Marca player._quitExplosionHidden = true
  ↓
Após 3.5s → performExitToMenu()
```

## Checklist de Regressão
1. Eliminar-se no jogo e confirmar explosão completa + tela de game over após ~3 s.
2. Abrir pause, selecionar "Quit" e observar explosão épica tocando antes do retorno ao menu.
3. Iniciar nova sessão e verificar se a nave aparece normalmente (flag resetada).

> Última revisão: 2025-02-15. Manter este arquivo como referência do comportamento correto e atualizar se o tempo da animação ou o fluxo de saída mudar.
