> [!NOTE]
Documento arquivado em 2025-10-10. Itens rastreados no novo plano: SeÃ§Ã£o 6.1 Checklists e critÃ©rios de saÃ­da. Consulte `docs/plans/docs-implementation-master-plan.md` para objetivos e critÃ©rios atualizados.

# Implementation Checklist - ASTEROIDS_ROGUEFIELD Improvements

_RevisÃ£o executada em 2025-10-08._

Este checklist foi atualizado para refletir o estado real das entregas de performance
implementadas no projeto. Cada seÃ§Ã£o destaca as evidÃªncias encontradas no cÃ³digo,
os gaps pendentes e as recomendaÃ§Ãµes para prÃ³ximos passos.

## ğŸ“Š Resumo da revisÃ£o
- A infraestrutura de **Object Pooling** estÃ¡ totalmente implementada e utilizada
  pelos sistemas crÃ­ticos (bullets, partÃ­culas, asteroides e orbes de XP), com
  scripts de validaÃ§Ã£o disponÃ­veis para auditoria rÃ¡pida.
- O **Spatial Hash** e as otimizaÃ§Ãµes do `PhysicsSystem` seguem ativos e cobertos
  por testes unitÃ¡rios, garantindo o ganho de performance planejado na fase 1.2.
- O **Batch Rendering** possui infraestrutura (`RenderBatch`, `CanvasStateManager`
  e `GradientCache`), porÃ©m a maioria dos sistemas ainda renderiza diretamente no
  `canvas`, mantendo a otimizaÃ§Ã£o como parcialmente concluÃ­da.
- O **GarbageCollectionManager** estÃ¡ inicializado e executando tarefas periÃ³dicas
  para auto-gerenciar os pools, atendendo ao plano de memÃ³ria da fase 1.4.
- Persistem pendÃªncias para um reset seguro das partÃ­culas (para evitar acumulaÃ§Ã£o
  no pool durante `reset()`) e para automatizar testes visuais/benchmarks de
  rendering.

## âœ… Estado consolidado
| Entrega | Status | EvidÃªncias principais | PrÃ³ximos passos |
|---------|--------|-----------------------|-----------------|
| Object Pool base (`ObjectPool`, `GamePools`) | âœ… ConcluÃ­do | `ObjectPool` define acquire/release e estatÃ­sticas, enquanto `GamePools.initialize()` prepara pools para balas, partÃ­culas, asteroides, orbes e objetos temporÃ¡rios. ã€F:src/core/ObjectPool.jsâ€ L1-L147ã€‘ã€F:src/core/GamePools.jsâ€ L1-L118ã€‘ | Manter monitoramento via `GamePools.getPoolStats()`.
| IntegraÃ§Ã£o de pooling nos sistemas | âœ… ConcluÃ­do | `CombatSystem`, `EffectsSystem`, `EnemySystem` e `XPOrbSystem` consomem `GamePools`. ã€F:src/modules/CombatSystem.jsâ€ L332-L614ã€‘ã€F:src/modules/EffectsSystem.jsâ€ L174-L513ã€‘ã€F:src/modules/EnemySystem.jsâ€ L240-L292ã€‘ã€F:src/modules/XPOrbSystem.jsâ€ L251-L269ã€‘ | Avaliar mÃ©tricas de pool durante sessÃµes longas.
| Reset seguro das partÃ­culas | ğŸ”„ PendÃªncia | `EffectsSystem.reset()` zera arrays mas nÃ£o devolve partÃ­culas ao pool, mantendo objetos no `Set inUse`. ã€F:src/modules/EffectsSystem.jsâ€ L1870-L1882ã€‘ | Implementar liberaÃ§Ã£o explÃ­cita ou `GamePools.particles.releaseAll()` antes do reset.
| Spatial Hash & PhysicsSystem | âœ… ConcluÃ­do | `SpatialHash` fornece queries otimizadas e o `PhysicsSystem` utiliza essa malha; testes `collision-accuracy` cobrem o fluxo. ã€F:src/core/SpatialHash.jsâ€ L1-L199ã€‘ã€F:src/modules/PhysicsSystem.jsâ€ L1-L220ã€‘ã€F:src/__tests__/physics/collision-accuracy.test.jsâ€ L1-L118ã€‘ | Continuar monitorando mÃ©tricas via `PhysicsSystem.performanceMetrics`.
| Batch Rendering | â³ Parcial | `RenderingSystem` inicializa `RenderBatch`/`CanvasStateManager`, mas delega o desenho para sistemas legados (`combat.render`, `enemies.render`, etc.), mantendo pouca reutilizaÃ§Ã£o das rotinas batched. ã€F:src/modules/RenderingSystem.jsâ€ L585-L663ã€‘ã€F:src/modules/RenderingSystem.jsâ€ L1008-L1156ã€‘ | Mapear chamadas elegÃ­veis para `renderBatchedCircles/Lines` e adaptar sistemas consumidores.
| Benchmarks & validaÃ§Ãµes | â³ Parcial | Existem scripts de validaÃ§Ã£o (`scripts/validate-object-pooling.js`, `scripts/benchmarks/batch-rendering-benchmark.js`), porÃ©m nÃ£o hÃ¡ testes automÃ¡ticos de regressÃ£o visual ou execuÃ§Ã£o em CI. ã€F:scripts/validate-object-pooling.jsâ€ L1-L116ã€‘ã€F:scripts/benchmarks/batch-rendering-benchmark.jsâ€ L1-L80ã€‘ | Integrar benchmarks na rotina de QA e documentar resultados esperados.
| GarbageCollectionManager | âœ… ConcluÃ­do | Inicializado em `app.js`, com tarefas periÃ³dicas que auto-gerenciam os pools (`pool-auto-manage`, `temp-pool-trim`). ã€F:src/app.jsâ€ L426-L454ã€‘ | Avaliar inclusÃ£o de tarefas para limpar caches especÃ­ficos quando necessÃ¡rio.

## ğŸ§­ Detalhes por fase

### ğŸš€ Fase 1.1 â€” Object Pooling System
- [x] **Implementar `ObjectPool` e `TTLObjectPool`** â€” disponÃ­veis em
  `src/core/ObjectPool.js`, com estatÃ­sticas, auto-manage e validaÃ§Ã£o.
- [x] **Criar registro central `GamePools`** â€” `GamePools.initialize()` prepara
  pools para bullets, partÃ­culas, asteroides, orbes de XP, ondas de choque e
  objetos temporÃ¡rios; `autoManageAll()` executa rotinas de manutenÃ§Ã£o. ã€F:src/core/GamePools.jsâ€ L33-L120ã€‘ã€F:src/core/GamePools.jsâ€ L496-L540ã€‘
- [x] **Integrar pools nos sistemas** â€” `CombatSystem`, `EffectsSystem`,
  `EnemySystem` e `XPOrbSystem` usam `acquire/release` diretamente. ã€F:src/modules/CombatSystem.jsâ€ L332-L614ã€‘ã€F:src/modules/EffectsSystem.jsâ€ L174-L513ã€‘
- [x] **Scripts de verificaÃ§Ã£o rÃ¡pida** â€” `scripts/validate-object-pooling.js`
  cobre aquisiÃ§Ã£o, liberaÃ§Ã£o e validaÃ§Ã£o dos pools. ã€F:scripts/validate-object-pooling.jsâ€ L1-L116ã€‘
- [ ] **Reset seguro em `EffectsSystem`** â€” adicionar liberaÃ§Ã£o das partÃ­culas
  ativas antes de zerar os arrays internos para evitar vazamento gradual. ã€F:src/modules/EffectsSystem.jsâ€ L1870-L1882ã€‘

### ğŸ›°ï¸ Fase 1.2 â€” OtimizaÃ§Ã£o de ColisÃ£o
- [x] **Implementar `SpatialHash`** â€” suporta inserÃ§Ã£o/remoÃ§Ã£o/atualizaÃ§Ã£o e
  consultas filtradas com raio variÃ¡vel. ã€F:src/core/SpatialHash.jsâ€ L1-L199ã€‘
- [x] **Refatorar `PhysicsSystem` para usar `SpatialHash`** â€” a malha Ã© usada
  para procurar asteroides prÃ³ximos e reduzir colisÃµes diretas. ã€F:src/modules/PhysicsSystem.jsâ€ L72-L220ã€‘
- [x] **Testes de precisÃ£o** â€” `src/__tests__/physics/collision-accuracy.test.js`
  compara o fluxo otimizado com o legado. ã€F:src/__tests__/physics/collision-accuracy.test.jsâ€ L1-L118ã€‘

### ğŸŒŒ Fase 1.3 â€” Batch Rendering
- [x] **Infraestrutura de batching** â€” `RenderBatch`, `CanvasStateManager` e
  `GradientCache` sÃ£o instanciados pelo `RenderingSystem`. ã€F:src/modules/RenderingSystem.jsâ€ L585-L612ã€‘
- [ ] **Refatorar sistemas de renderizaÃ§Ã£o** â€” `renderOptimized()` ainda delega
  para `xpOrbs.render`, `combat.render`, `enemies.render`, etc., mantendo mÃºltiplas
  mudanÃ§as de estado no canvas. ã€F:src/modules/RenderingSystem.jsâ€ L1008-L1097ã€‘
- [ ] **Testes visuais & benchmarks integrados** â€” scripts existem, mas nÃ£o hÃ¡
  automaÃ§Ã£o para comparar screenshots ou validar ganhos no build oficial.

### ğŸ§¹ Fase 1.4 â€” Memory Management
- [x] **Inicializar `GarbageCollectionManager`** â€” criado em `app.js` com tarefas
  periÃ³dicas para auto-gerenciar pools. ã€F:src/app.jsâ€ L426-L454ã€‘
- [x] **Ajustar pooling temporÃ¡rio** â€” tarefa `temp-pool-trim` chama `autoManage`
  do pool temporÃ¡rio com metas de utilizaÃ§Ã£o. ã€F:src/app.jsâ€ L437-L454ã€‘
- [ ] **Cobrir outros caches** â€” avaliar inclusÃ£o de rotinas para limpar caches
  de gradientes/estado conforme plano original.

## ğŸ“ RecomendaÃ§Ãµes
1. Priorizar a correÃ§Ã£o do reset das partÃ­culas para evitar acumulaÃ§Ã£o no pool
   apÃ³s retornos ao menu ou reinicializaÃ§Ãµes prolongadas.
2. Mapear os pontos de renderizaÃ§Ã£o que ainda usam o fluxo legado e criar um
   plano incremental para migrÃ¡-los para os mÃ©todos batched.
3. Automatizar a execuÃ§Ã£o dos scripts de benchmark e registrar resultados na
   documentaÃ§Ã£o de validaÃ§Ã£o para manter histÃ³rico de performance.
